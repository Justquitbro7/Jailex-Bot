<!DOCTYPE html>
<html>
<head><title>Jailex Auth Handler</title></head>
<body style="background:#020617; color:white; text-align:center; padding:50px; font-family:sans-serif;">
    <h2 id="status">SYNCING WITH JAILEX...</h2>
    <script>
        const hash = window.location.hash;
        if (hash) {
            const params = new URLSearchParams(hash.substring(1));
            const token = params.get('access_token');
            if (token && window.opener) {
                // EXPLICIT TARGET: Replace '*' with your actual Vercel URL for security
                window.opener.postMessage({ 
                    type: 'TWITCH_TOKEN', 
                    token: token 
                }, "https://jailex.vercel.app"); 
                
                document.getElementById('status').innerText = "SYNC SUCCESSFUL!";
                setTimeout(() => window.close(), 800);
            }
        } else {
            document.getElementById('status').innerText = "NO SIGNAL DETECTED.";
        }
    </script>
</body>
</html>
