<!DOCTYPE html>
<html>
<head><title>JAILEX | Handshake</title></head>
<body style="background:#020617; color:white; font-family:sans-serif; display:flex; align-items:center; justify-content:center; height:100vh;">
    <div style="text-align:center;">
        <h2 style="color:#C83803;">HANDSHAKE SECURED</h2>
        <p id="status">Syncing token with JAILEX Studio...</p>
        <button onclick="goHome()" style="background:#C83803; color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer; font-weight:bold; margin-top:20px;">RETURN TO STUDIO</button>
    </div>

    <script>
        // 1. Capture the token from the URL
        const hash = window.location.hash;
        if (hash.includes('access_token=')) {
            const token = hash.split('access_token=')[1].split('&')[0];
            // Store it in LocalStorage (Vercel domain)
            localStorage.setItem('jailex_tmp_token', token);
            
            // 2. Try to redirect back to the local file
            // We use 'referrer' to find where you just came from (v9.6.x)
            const returnPath = document.referrer || "file:///C:/Users/Justquitbro7/Desktop/index.html";
            window.location.href = returnPath + hash;
        }

        function goHome() {
            window.history.back(); // Simple way to go back to the version that sent you here
        }
    </script>
</body>
</html>
